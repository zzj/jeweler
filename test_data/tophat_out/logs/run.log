/nas02/home/z/z/zzj/bin/bin//tophat test_genome left.fq right.fq
/nas02/home/z/z/zzj/bin/bin/prep_reads --min-anchor 8 --splice-mismatches 0 --min-report-intron 50 --max-report-intron 500000 --min-isoform-fraction 0.15 --output-dir ./tophat_out/ --max-multihits 20 --segment-length 25 --segment-mismatches 2 --min-closure-exon 100 --min-closure-intron 50 --max-closure-intron 5000 --min-coverage-intron 50 --max-coverage-intron 20000 --min-segment-intron 50 --max-segment-intron 500000 --max-mismatches 2 --sam-header ./tophat_out/tmp/stub_header.sam --max-insertion-length 3 --max-deletion-length 3 -z gzip --inner-dist-mean 50 --inner-dist-std-dev 20 --no-closure-search --no-microexon-search --fasta --aux-outfile=./tophat_out/left_kept_reads.info left.fq | gzip -c - >./tophat_out/tmp/left_kept_reads.fq.z
/nas02/home/z/z/zzj/bin/bin/prep_reads --min-anchor 8 --splice-mismatches 0 --min-report-intron 50 --max-report-intron 500000 --min-isoform-fraction 0.15 --output-dir ./tophat_out/ --max-multihits 20 --segment-length 25 --segment-mismatches 2 --min-closure-exon 100 --min-closure-intron 50 --max-closure-intron 5000 --min-coverage-intron 50 --max-coverage-intron 20000 --min-segment-intron 50 --max-segment-intron 500000 --max-mismatches 2 --sam-header ./tophat_out/tmp/stub_header.sam --max-insertion-length 3 --max-deletion-length 3 -z gzip --inner-dist-mean 50 --inner-dist-std-dev 20 --no-closure-search --no-microexon-search --fasta --aux-outfile=./tophat_out/right_kept_reads.info right.fq | gzip -c - >./tophat_out/tmp/right_kept_reads.fq.z
gzip -cd< ./tophat_out/tmp/left_kept_reads.fq.z|/nas02/apps/bowtie-0.12.8/bin/bowtie -q --un ./tophat_out/tmp/left_kept_reads_unmapped.fq -v 2 -p 1 -k 20 -m 20 --max /dev/null test_genome -|/nas02/home/z/z/zzj/bin/bin/fix_map_ordering -|gzip -c > ./tophat_out/tmp/left_kept_reads.bwtout.z
/nas02/home/z/z/zzj/bin/bin/long_spanning_reads --min-anchor 8 --splice-mismatches 0 --min-report-intron 50 --max-report-intron 500000 --min-isoform-fraction 0.15 --output-dir ./tophat_out/ --max-multihits 20 --segment-length 25 --segment-mismatches 2 --min-closure-exon 100 --min-closure-intron 50 --max-closure-intron 5000 --min-coverage-intron 50 --max-coverage-intron 20000 --min-segment-intron 50 --max-segment-intron 500000 --max-mismatches 2 --sam-header ./tophat_out/tmp/stub_header.sam --max-insertion-length 3 --max-deletion-length 3 -z gzip --inner-dist-mean 50 --inner-dist-std-dev 20 --no-closure-search --no-coverage-search --no-microexon-search test_genome.fa ./tophat_out/tmp/left_kept_reads.fq.z /dev/null /dev/null /dev/null ./tophat_out/tmp/left_kept_reads.bwtout.z > ./tophat_out/tmp/left_kept_reads.unspl.bam
gzip -cd< ./tophat_out/tmp/left_kept_reads_seg1.fq.z|/nas02/apps/bowtie-0.12.8/bin/bowtie -q --un ./tophat_out/tmp/left_kept_reads_seg1_unmapped.fq -v 2 -p 1 -k 40 -m 40 --max /dev/null test_genome -|/nas02/home/z/z/zzj/bin/bin/fix_map_ordering -|gzip -c > ./tophat_out/tmp/left_kept_reads_seg1.bwtout.z
gzip -cd< ./tophat_out/tmp/left_kept_reads_seg2.fq.z|/nas02/apps/bowtie-0.12.8/bin/bowtie -q --un ./tophat_out/tmp/left_kept_reads_seg2_unmapped.fq -v 2 -p 1 -k 40 -m 40 --max /dev/null test_genome -|/nas02/home/z/z/zzj/bin/bin/fix_map_ordering -|gzip -c > ./tophat_out/tmp/left_kept_reads_seg2.bwtout.z
gzip -cd< ./tophat_out/tmp/left_kept_reads_seg3.fq.z|/nas02/apps/bowtie-0.12.8/bin/bowtie -q --un ./tophat_out/tmp/left_kept_reads_seg3_unmapped.fq -v 2 -p 1 -k 40 -m 40 --max /dev/null test_genome -|/nas02/home/z/z/zzj/bin/bin/fix_map_ordering -|gzip -c > ./tophat_out/tmp/left_kept_reads_seg3.bwtout.z
gzip -cd< ./tophat_out/tmp/right_kept_reads.fq.z|/nas02/apps/bowtie-0.12.8/bin/bowtie -q --un ./tophat_out/tmp/right_kept_reads_unmapped.fq -v 2 -p 1 -k 20 -m 20 --max /dev/null test_genome -|/nas02/home/z/z/zzj/bin/bin/fix_map_ordering -|gzip -c > ./tophat_out/tmp/right_kept_reads.bwtout.z
/nas02/home/z/z/zzj/bin/bin/long_spanning_reads --min-anchor 8 --splice-mismatches 0 --min-report-intron 50 --max-report-intron 500000 --min-isoform-fraction 0.15 --output-dir ./tophat_out/ --max-multihits 20 --segment-length 25 --segment-mismatches 2 --min-closure-exon 100 --min-closure-intron 50 --max-closure-intron 5000 --min-coverage-intron 50 --max-coverage-intron 20000 --min-segment-intron 50 --max-segment-intron 500000 --max-mismatches 2 --sam-header ./tophat_out/tmp/stub_header.sam --max-insertion-length 3 --max-deletion-length 3 -z gzip --inner-dist-mean 50 --inner-dist-std-dev 20 --no-closure-search --no-coverage-search --no-microexon-search test_genome.fa ./tophat_out/tmp/right_kept_reads.fq.z /dev/null /dev/null /dev/null ./tophat_out/tmp/right_kept_reads.bwtout.z > ./tophat_out/tmp/right_kept_reads.unspl.bam
gzip -cd< ./tophat_out/tmp/right_kept_reads_seg1.fq.z|/nas02/apps/bowtie-0.12.8/bin/bowtie -q --un ./tophat_out/tmp/right_kept_reads_seg1_unmapped.fq -v 2 -p 1 -k 40 -m 40 --max /dev/null test_genome -|/nas02/home/z/z/zzj/bin/bin/fix_map_ordering -|gzip -c > ./tophat_out/tmp/right_kept_reads_seg1.bwtout.z
gzip -cd< ./tophat_out/tmp/right_kept_reads_seg2.fq.z|/nas02/apps/bowtie-0.12.8/bin/bowtie -q --un ./tophat_out/tmp/right_kept_reads_seg2_unmapped.fq -v 2 -p 1 -k 40 -m 40 --max /dev/null test_genome -|/nas02/home/z/z/zzj/bin/bin/fix_map_ordering -|gzip -c > ./tophat_out/tmp/right_kept_reads_seg2.bwtout.z
gzip -cd< ./tophat_out/tmp/right_kept_reads_seg3.fq.z|/nas02/apps/bowtie-0.12.8/bin/bowtie -q --un ./tophat_out/tmp/right_kept_reads_seg3_unmapped.fq -v 2 -p 1 -k 40 -m 40 --max /dev/null test_genome -|/nas02/home/z/z/zzj/bin/bin/fix_map_ordering -|gzip -c > ./tophat_out/tmp/right_kept_reads_seg3.bwtout.z
/nas02/home/z/z/zzj/bin/bin/segment_juncs --min-anchor 8 --splice-mismatches 0 --min-report-intron 50 --max-report-intron 500000 --min-isoform-fraction 0.15 --output-dir ./tophat_out/ --max-multihits 20 --segment-length 25 --segment-mismatches 2 --min-closure-exon 100 --min-closure-intron 50 --max-closure-intron 5000 --min-coverage-intron 50 --max-coverage-intron 20000 --min-segment-intron 50 --max-segment-intron 500000 --max-mismatches 2 --sam-header ./tophat_out/tmp/stub_header.sam --max-insertion-length 3 --max-deletion-length 3 -z gzip --inner-dist-mean 50 --inner-dist-std-dev 20 --no-closure-search --no-coverage-search --no-microexon-search --ium-reads ./tophat_out/tmp/left_kept_reads_seg1_unmapped.fq,./tophat_out/tmp/left_kept_reads_seg2_unmapped.fq,./tophat_out/tmp/left_kept_reads_seg3_unmapped.fq,./tophat_out/tmp/right_kept_reads_seg1_unmapped.fq,./tophat_out/tmp/right_kept_reads_seg2_unmapped.fq,./tophat_out/tmp/right_kept_reads_seg3_unmapped.fq test_genome.fa ./tophat_out/tmp/segment.juncs ./tophat_out/tmp/segment.insertions ./tophat_out/tmp/segment.deletions ./tophat_out/tmp/left_kept_reads.fq.z ./tophat_out/tmp/left_kept_reads.bwtout.z ./tophat_out/tmp/left_kept_reads_seg1.bwtout.z,./tophat_out/tmp/left_kept_reads_seg2.bwtout.z,./tophat_out/tmp/left_kept_reads_seg3.bwtout.z ./tophat_out/tmp/right_kept_reads.fq.z ./tophat_out/tmp/right_kept_reads.bwtout.z ./tophat_out/tmp/right_kept_reads_seg1.bwtout.z,./tophat_out/tmp/right_kept_reads_seg2.bwtout.z,./tophat_out/tmp/right_kept_reads_seg3.bwtout.z
/nas02/home/z/z/zzj/bin/bin/juncs_db 3 25 ./tophat_out/tmp/segment.juncs /dev/null /dev/null test_genome.fa
/nas02/apps/bowtie-0.12.8/bin/bowtie-build ./tophat_out/tmp/segment_juncs.fa ./tophat_out/tmp/segment_juncs
gzip -cd< ./tophat_out/tmp/left_kept_reads_seg1.fq.z|/nas02/apps/bowtie-0.12.8/bin/bowtie -q -v 2 -p 1 -k 40 -m 40 --max /dev/null ./tophat_out/tmp/segment_juncs -|/nas02/home/z/z/zzj/bin/bin/fix_map_ordering -|gzip -c > ./tophat_out/tmp/left_kept_reads_seg1.to_spliced.bwtout.z
gzip -cd< ./tophat_out/tmp/left_kept_reads_seg2.fq.z|/nas02/apps/bowtie-0.12.8/bin/bowtie -q -v 2 -p 1 -k 40 -m 40 --max /dev/null ./tophat_out/tmp/segment_juncs -|/nas02/home/z/z/zzj/bin/bin/fix_map_ordering -|gzip -c > ./tophat_out/tmp/left_kept_reads_seg2.to_spliced.bwtout.z
gzip -cd< ./tophat_out/tmp/left_kept_reads_seg3.fq.z|/nas02/apps/bowtie-0.12.8/bin/bowtie -q -v 2 -p 1 -k 40 -m 40 --max /dev/null ./tophat_out/tmp/segment_juncs -|/nas02/home/z/z/zzj/bin/bin/fix_map_ordering -|gzip -c > ./tophat_out/tmp/left_kept_reads_seg3.to_spliced.bwtout.z
/nas02/home/z/z/zzj/bin/bin/long_spanning_reads --min-anchor 8 --splice-mismatches 0 --min-report-intron 50 --max-report-intron 500000 --min-isoform-fraction 0.15 --output-dir ./tophat_out/ --max-multihits 20 --segment-length 25 --segment-mismatches 2 --min-closure-exon 100 --min-closure-intron 50 --max-closure-intron 5000 --min-coverage-intron 50 --max-coverage-intron 20000 --min-segment-intron 50 --max-segment-intron 500000 --max-mismatches 2 --sam-header ./tophat_out/tmp/stub_header.sam --max-insertion-length 3 --max-deletion-length 3 -z gzip --inner-dist-mean 50 --inner-dist-std-dev 20 --no-closure-search --no-coverage-search --no-microexon-search test_genome.fa ./tophat_out/tmp/left_kept_reads.fq.z ./tophat_out/tmp/segment.juncs /dev/null /dev/null ./tophat_out/tmp/left_kept_reads_seg1.bwtout.z,./tophat_out/tmp/left_kept_reads_seg2.bwtout.z,./tophat_out/tmp/left_kept_reads_seg3.bwtout.z ./tophat_out/tmp/left_kept_reads_seg1.to_spliced.bwtout.z,./tophat_out/tmp/left_kept_reads_seg2.to_spliced.bwtout.z,./tophat_out/tmp/left_kept_reads_seg3.to_spliced.bwtout.z > ./tophat_out/tmp/left_kept_reads.candidates.bam
/nas02/home/z/z/zzj/bin/bin/bam_merge ./tophat_out/tmp/left_kept_reads.candidates_and_unspl.bam ./tophat_out/tmp/left_kept_reads.candidates.bam ./tophat_out/tmp/left_kept_reads.unspl.bam
gzip -cd< ./tophat_out/tmp/right_kept_reads_seg1.fq.z|/nas02/apps/bowtie-0.12.8/bin/bowtie -q -v 2 -p 1 -k 40 -m 40 --max /dev/null ./tophat_out/tmp/segment_juncs -|/nas02/home/z/z/zzj/bin/bin/fix_map_ordering -|gzip -c > ./tophat_out/tmp/right_kept_reads_seg1.to_spliced.bwtout.z
gzip -cd< ./tophat_out/tmp/right_kept_reads_seg2.fq.z|/nas02/apps/bowtie-0.12.8/bin/bowtie -q -v 2 -p 1 -k 40 -m 40 --max /dev/null ./tophat_out/tmp/segment_juncs -|/nas02/home/z/z/zzj/bin/bin/fix_map_ordering -|gzip -c > ./tophat_out/tmp/right_kept_reads_seg2.to_spliced.bwtout.z
gzip -cd< ./tophat_out/tmp/right_kept_reads_seg3.fq.z|/nas02/apps/bowtie-0.12.8/bin/bowtie -q -v 2 -p 1 -k 40 -m 40 --max /dev/null ./tophat_out/tmp/segment_juncs -|/nas02/home/z/z/zzj/bin/bin/fix_map_ordering -|gzip -c > ./tophat_out/tmp/right_kept_reads_seg3.to_spliced.bwtout.z
/nas02/home/z/z/zzj/bin/bin/long_spanning_reads --min-anchor 8 --splice-mismatches 0 --min-report-intron 50 --max-report-intron 500000 --min-isoform-fraction 0.15 --output-dir ./tophat_out/ --max-multihits 20 --segment-length 25 --segment-mismatches 2 --min-closure-exon 100 --min-closure-intron 50 --max-closure-intron 5000 --min-coverage-intron 50 --max-coverage-intron 20000 --min-segment-intron 50 --max-segment-intron 500000 --max-mismatches 2 --sam-header ./tophat_out/tmp/stub_header.sam --max-insertion-length 3 --max-deletion-length 3 -z gzip --inner-dist-mean 50 --inner-dist-std-dev 20 --no-closure-search --no-coverage-search --no-microexon-search test_genome.fa ./tophat_out/tmp/right_kept_reads.fq.z ./tophat_out/tmp/segment.juncs /dev/null /dev/null ./tophat_out/tmp/right_kept_reads_seg1.bwtout.z,./tophat_out/tmp/right_kept_reads_seg2.bwtout.z,./tophat_out/tmp/right_kept_reads_seg3.bwtout.z ./tophat_out/tmp/right_kept_reads_seg1.to_spliced.bwtout.z,./tophat_out/tmp/right_kept_reads_seg2.to_spliced.bwtout.z,./tophat_out/tmp/right_kept_reads_seg3.to_spliced.bwtout.z > ./tophat_out/tmp/right_kept_reads.candidates.bam
/nas02/home/z/z/zzj/bin/bin/bam_merge ./tophat_out/tmp/right_kept_reads.candidates_and_unspl.bam ./tophat_out/tmp/right_kept_reads.candidates.bam ./tophat_out/tmp/right_kept_reads.unspl.bam
/nas02/home/z/z/zzj/bin/bin/tophat_reports --min-anchor 8 --splice-mismatches 0 --min-report-intron 50 --max-report-intron 500000 --min-isoform-fraction 0.15 --output-dir ./tophat_out/ --max-multihits 20 --segment-length 25 --segment-mismatches 2 --min-closure-exon 100 --min-closure-intron 50 --max-closure-intron 5000 --min-coverage-intron 50 --max-coverage-intron 20000 --min-segment-intron 50 --max-segment-intron 500000 --max-mismatches 2 --sam-header ./tophat_out/tmp/stub_header.sam --max-insertion-length 3 --max-deletion-length 3 -z gzip --inner-dist-mean 50 --inner-dist-std-dev 20 --no-closure-search --no-coverage-search --no-microexon-search --samtools=/nas02/apps/samtools-0.1.18/bin/samtools ./tophat_out/junctions.bed ./tophat_out/insertions.bed ./tophat_out/deletions.bed - ./tophat_out/tmp/left_kept_reads.candidates_and_unspl.bam ./tophat_out/tmp/left_kept_reads.fq.z ./tophat_out/tmp/right_kept_reads.candidates_and_unspl.bam ./tophat_out/tmp/right_kept_reads.fq.z | /nas02/apps/samtools-0.1.18/bin/samtools sort - ./tophat_out/accepted_hits
